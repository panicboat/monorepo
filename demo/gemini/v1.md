# PrivateHeaven - MVP 開発要件定義書

## 1. プロジェクト概要
* **サービス名:** PrivateHeaven (仮)
* **コンセプト:** 店舗依存からの脱却。キャスト個人の「信用資産」を可視化するポートフォリオ兼予約管理ツール。
* **プラットフォーム:** PWA (Next.js + Supabase)
* **コア体験 (Core Value):** "The Premium Promise"
* 予約を事務作業ではなく「特別な誓約（儀式）」として演出する。
* チャットベースの交渉 → リッチな招待状送付 → 長押しによる誓約 → 確定。

## 2. ターゲットユーザーと解決する負
* **User (客):**
* 「地雷（写真詐欺・態度悪）」を踏みたくない → **来店認証済みレビュー**で解決。
* 事務的な予約作業がつまらない → **高級感ある儀式UI**で「口説き落とした感」を演出。
* **Cast (嬢):**
* 移籍で客がリセットされる → **IDと評価を持ち運べる**仕組みで解決。
* ドタキャンが怖い → **誓約の心理的ハードル**と**No Show履歴の共有**で解決。

## 3. 技術スタック
* **Frontend:** Next.js (App Router), Tailwind CSS, Framer Motion, Lucide React
* **Backend:** Supabase (Database, Auth, Storage, Realtime)
* **Infra:** Vercel

## 4. データベース設計 (Supabase / PostgreSQL)

### A. Users & Profiles
* **`casts`**
* `id`: uuid (PK)
* `display_name`: text (源氏名)
* `shop_name`: text (現在の所属店タグ)
* `images`: text[] (ポートフォリオ画像)
* `tags`: text[] (自称タグ: #Sっ気 など)
* `is_verified`: boolean (本人確認バッジ)
* **`customers`**
* `id`: uuid (PK)
* `no_show_count`: integer (無断キャンセル回数)
* `visit_count`: integer (利用回数)

### B. Communication (Ritual Logic)
* **`rooms`**
* `id`: uuid (PK), `cast_id`, `customer_id`
* **`messages`**
* `id`: uuid (PK), `room_id`, `sender_id`, `content`
* `type`: text ('text' | 'invitation' | 'image')
* `payload`: jsonb (招待状の場合、予約IDなどのメタデータ)
* **`reservations`**
* `id`: uuid (PK)
* `status`: text ('offered' | 'confirmed' | 'visited' | 'no_show')
* `start_at`: timestamp, `price_estimated`: integer

### C. Assets (Trust)
* **`reviews`**
* `reservation_id`: uuid (FK, Unique) - **来店済み予約のみ作成可**
* `rating_promise`: integer (約束を守ったか、時間の価値評価)
* `tags_given`: text[] (他己紹介タグ: #写真より可愛い など)

## 5. UI/UX 実装要件 (The Premium Promise)
* **招待状 (Invitation):**
* チャット内に埋め込まれるリッチなカードコンポーネント。
* 金・黒を基調とした高級クラブの会員証のようなデザイン。
* **誓約の儀式 (Ritual):**
* 「予約する」ボタンはタップではなく**「長押し(Long Press)」**で完了する。
* 長押し中、プログレスリングが進行し、完了時にスマホが振動(Haptic)する。
* **確定後 (Sealed):**
* カードが「PROMISED」という封蝋（シーリングスタンプ）デザインに変化する。
