syntax = "proto3";

package portfolio.v1;

// import "buf/validate/validate.proto";

service CastService {
  rpc GetCastProfile(GetCastProfileRequest) returns (GetCastProfileResponse);
  rpc CreateCastProfile(CreateCastProfileRequest) returns (CreateCastProfileResponse);
  rpc UpdateCastProfile(UpdateCastProfileRequest) returns (UpdateCastProfileResponse);
  rpc UpdateCastImages(UpdateCastImagesRequest) returns (UpdateCastImagesResponse);
  rpc UpdateCastPlans(UpdateCastPlansRequest) returns (UpdateCastPlansResponse);
  rpc UpdateCastSchedules(UpdateCastSchedulesRequest) returns (UpdateCastSchedulesResponse);
  rpc ListCasts(ListCastsRequest) returns (ListCastsResponse);
  rpc GetUploadUrl(GetUploadUrlRequest) returns (GetUploadUrlResponse);
  rpc UpdateCastStatus(UpdateCastStatusRequest) returns (UpdateCastStatusResponse);
}

enum CastStatus {
  CAST_STATUS_UNSPECIFIED = 0;
  CAST_STATUS_OFFLINE = 1;
  CAST_STATUS_ASKING = 2; // "Asking" or "Break"
  CAST_STATUS_ONLINE = 3;
  CAST_STATUS_TONIGHT = 4;
}

message SocialLinks {
  string x = 1;
  string instagram = 2;
  string tiktok = 3;
  string cityheaven = 4;
  string litlink = 5;
  repeated string others = 6;
}

message CastProfile {
  string user_id = 1;
  string name = 2;
  string bio = 3;
  string image_url = 4;
  CastStatus status = 5;
  // promise_rate should be calculated, maybe not stored here directly or read-only
  double promise_rate = 6;
  repeated string images = 7;
  string image_path = 8;
  string tagline = 9;
  string service_category = 10;
  string location_type = 11;
  string area = 12;
  string default_shift_start = 13;
  string default_shift_end = 14;
  SocialLinks social_links = 15;
}

message CastPlan {
  string id = 1;
  string name = 2;
  int32 price = 3; // JPY
  int32 duration_minutes = 4;
}

message GetCastProfileRequest {
  string user_id = 1; // [(buf.validate.field).string.uuid = true];
}

message GetCastProfileResponse {
  CastProfile profile = 1;
  repeated CastPlan plans = 2;
  repeated CastSchedule schedules = 3;
}

message CreateCastProfileRequest {
  string name = 1;
  string bio = 2;
  string image_path = 3;
  string tagline = 4;
  string service_category = 5;
  string location_type = 6;
  string area = 7;
  string default_shift_start = 8;
  string default_shift_end = 9;
  SocialLinks social_links = 10;
}

message CreateCastProfileResponse {
  CastProfile profile = 1;
}

message UpdateCastProfileRequest {
  string name = 1;
  string bio = 2;
  string image_path = 3;
  string tagline = 4;
  string service_category = 5;
  string location_type = 6;
  string area = 7;
  string default_shift_start = 8;
  string default_shift_end = 9;
  SocialLinks social_links = 10;
}

message UpdateCastProfileResponse {
  CastProfile profile = 1;
}

message UpdateCastImagesRequest {
  string profile_image_path = 1; // Cover/Profile image
  repeated string gallery_images = 2; // List of image URLs or Paths
}

message UpdateCastImagesResponse {
  CastProfile profile = 1;
}

message UpdateCastPlansRequest {
  repeated CastPlan plans = 1;
}

message UpdateCastPlansResponse {
  repeated CastPlan plans = 1;
}

message UpdateCastSchedulesRequest {
  repeated CastSchedule schedules = 1;
}

message UpdateCastSchedulesResponse {
  repeated CastSchedule schedules = 1;
}

message GetUploadUrlRequest {
  string filename = 1;
  string content_type = 2;
}

message GetUploadUrlResponse {
  string url = 1;
  string key = 2;
}

message CastSchedule {
  string date = 1; // YYYY-MM-DD
  string start_time = 2; // HH:mm
  string end_time = 3; // HH:mm
  string plan_id = 4; // Optional
}

message ListCastsRequest {
  // Add filters if needed, e.g. status
  CastStatus status_filter = 1;
}

message ListCastsResponse {
  message CastItem {
    CastProfile profile = 1;
    repeated CastPlan plans = 2;
  }
  repeated CastItem items = 1;
}

message UpdateCastStatusRequest {
  CastStatus status = 1;
}

message UpdateCastStatusResponse {
  CastStatus status = 1;
}
