# Proposal: Add Comment Feature

## Overview

投稿へのコメント機能を実装する。ゲストとキャストの両方がキャストの投稿にコメントを追加し、コメント一覧を閲覧できるようにする。

## Motivation

Phase 1.4 として計画されている機能。いいね・フォロー機能に続き、ソーシャルインタラクションの基盤を完成させる。コメント機能により、ゲストとキャスト間の双方向コミュニケーションが活性化し、エンゲージメントが向上する。

## User Stories

### Guest

1. **ゲストとして、投稿にコメントを追加したい**（自分の意見や感想を伝えるため）
2. **ゲストとして、コメントに写真や動画を添付したい**（視覚的に伝えるため）
3. **ゲストとして、投稿のコメント一覧を閲覧したい**（他のユーザーの反応を見るため）
4. **ゲストとして、コメントに返信したい**（会話を続けるため）
5. **ゲストとして、自分のコメントを削除したい**（間違いを修正するため）

### Cast

6. **キャストとして、自分の投稿へのコメントを確認したい**（ゲストからのフィードバックを得るため）
7. **キャストとして、投稿にコメントを追加したい**（ゲストとの会話に参加するため）
8. **キャストとして、コメントに返信したい**（ゲストの質問や感想に応えるため）
9. **キャストとして、自分のコメントを削除したい**（間違いを修正するため）

## Scope

### In Scope

- `post_comments` テーブルの作成
- `comment_media` テーブルの作成（メディア添付用）
- Proto 定義の追加（`AddComment`, `DeleteComment`, `ListComments`, `ListReplies`）
- Backend UseCase の実装
- Frontend API Route の作成
- コメント一覧・投稿 UI の実装
- コメントへのメディア添付機能（画像/動画、最大3枚）
- コメントへの返信機能（1階層のみ）
- 投稿詳細ページへのコメントセクション追加

### Out of Scope

- 2階層以上のネストした返信
- コメントの編集機能
- コメントへのいいね機能
- コメント通知（Phase 6.4 で対応予定）
- コメントの報告機能

## Related

- `openspec/specs/timeline/spec.md` - 既存のタイムライン仕様（修正対象）
- Phase 1.2 Like Feature - 完了済み
- Phase 1.3 Follow Feature - 完了済み
